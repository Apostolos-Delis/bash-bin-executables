#!/usr/bin/env bash

print_help(){
    echo "use version 1.0"
    echo "USAGE: use [OPTIONS] <COMMAND>"
    echo "greps history for command usage frequency"
    echo
    echo "Options: "
    echo "      -p, --percent   shows a percentage of the commands frequency compared to the entire history"
    echo "      -a, --actual    shows the actual matches in the history rather than just the number of matches"
    echo "      -h, --help      shows the documentation for use"
    echo
    echo "Example: use -p ls    <- shows what percantage of the total commands used was ls"
}

if [ "$#" -ge "1" ]; then

    if [ $1 = '-a' ] || [ $1 = '--actual' ]; then
        cat ~/.bash_history | grep "$2"   

    elif [ "$1" = '-p' ] || [ "$1" = '--percent' ]; then
        total=`cat ~/.bash_history | wc -l`
        num_executed=`cat ~/.bash_history | grep "$2" | wc -l`
        echo -n "0"
        bc <<< "scale = 3; ($num_executed / $total)"

    elif [ "$1" = '-h' ] || [ "$1" = '--help' ]; then
        print_help

    else
        num_executed=`cat ~/.bash_history | grep "$1" | wc -l`
        echo "$num_executed"
    fi
    
else
    print_help
fi
